- to configure the SSH, we only require configuration or setup on the FortiSIEM side. only because the SSH is configured by default with the FortiGate
- all we need to do along with the normal credential configuration on the FortiSIEM side is to actually do the configuration related to enforcing the authentication method to use password authentication instead of public key authentication, because this is the default method of the SSH client inside the FortiSIEM collector
	- SSH client of the FortiSIEM collector when tries to connect to the FortiGate, it will tries the public key authentication first

- To override the behavior and enforce the password authentication over the public key authentication, we just need to edit `/etc/ssh/ssh_config` and modify two parameters

- best practice is always take the backup of the file and then you can edit the `ssh_config` file

```bash
Protocol: SSH
--------------
Used for: Performance Monitoring, Security and Compliance
---------------------------------------------------------
Information Discovered: Running configuration
---------------------------------------------
Metrics collected: Configuration Change
=======================================
Add these two lines to /etc/ssh/ssh_config of the FortiSIEM collector so its SSH Client prefer password authentication over public key authentication when connecting to the ForiGate:
	PreferredAuthentications password
	PubkeyAuthentication no
```

- add this two configuration at the end in FortiCollector.
- then we need to define the credentials in the FortiSIEM in `ADMIN > Credentials > Step1: Enter Credentials > New`
	- There are 3 methods in `Password config`
		- CyberArk is the PAM solution (privilege access management solution), where you can have in you infrastructure to manage the different credentials for your network or security devices
			- its like password vault for your devices
	- there are other PAM solution, but these are the only 3 solutions FortiSIEM able to integrate as of now
	- `Super Password` is for if you have levels for `Generic` `Device Type` (means, there is no FortiGate in the `Device Type` section, its generic)
		- some devices will have levels for the SSH (e.g., Cisco devices)

![[FortiSIEM U/Section 02 - Device Discovery/012.png]]

- `Step 2: Enter IP Range to Credential Associations`
	- select `Discoverd by FortiCollector` in the right hand side, and edit or add the second method as SSH (i.e., `FortiGate-SSH-Credentials`)
		- we need to add IP of the collector and the credential we defined in the first step
	- now `Step 2: > Test > Test Connectivity`

- when we do `Discovery` it will be using the credentials we defined in step 1 and step 2
- go to `ADMIN > Discovery`, ensure you selected `Discovered by FortiCollector`, then select `Discover` if you previously configured using `New`
- we can also schedule the discovery
- you can use the tcpdump to check the progress

- here you can see both methods (SNMP and SSH) has been utilized

![[FortiSIEM U/Section 02 - Device Discovery/013.png]]

- you can see the `Config change` in the monitoring list, that means SSH configuration is working fine

![[FortiSIEM U/Section 02 - Device Discovery/014.png]]

- we can double check by going to `CMDB > Devices > Network Device >` then choose the groups that is associated with the FortiGate (e.g., WLAN Controller)
- last time we didn't have the configuration, this time it will be there

![[FortiSIEM U/Section 02 - Device Discovery/015.png]]

- this is the startup configuration of the FortiGate
- you can schedule the discovery also

![[FortiSIEM U/Section 02 - Device Discovery/016.png]]




